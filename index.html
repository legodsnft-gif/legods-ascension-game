<script>
        // --- Game State Variables ---
        let aura = 0;
        let auraPerClick = 1;
        let auraPerSecond = 0;

        // --- UPGRADE DATA ---
        
        // Passive Upgrades (APS Boosters)
        const passiveUpgrades = [
            { id: 0, name: "Minor Deity", cost: 10, aps: 0.5, owned: 0, baseCost: 10 },
            { id: 1, name: "Sacred Relic", cost: 100, aps: 5, owned: 0, baseCost: 100 },
            { id: 2, name: "Mythic Steed", cost: 1000, aps: 40, owned: 0, baseCost: 1000 },
            { id: 3, name: "The Oracle's Blessing", cost: 15000, aps: 500, owned: 0, baseCost: 15000 },
            { id: 4, name: "The Throne of Olympus", cost: 100000, aps: 6000, owned: 0, baseCost: 100000 }
        ];

        // NEW Click Upgrades (Click Power Boosters)
        const clickUpgrades = [
            { id: 10, name: "Divine Focus", cost: 50, clickBoost: 2, owned: 0, baseCost: 50 },
            { id: 11, name: "Zeus's Hand", cost: 5000, clickBoost: 50, owned: 0, baseCost: 5000 },
            { id: 12, name: "Cosmic Tap", cost: 100000, clickBoost: 1000, owned: 0, baseCost: 100000 }
        ];

        // --- DOM Elements ---
        const powerDisplay = document.getElementById('power-display');
        const apsDisplay = document.getElementById('aps-display');
        const clickPowerDisplay = document.getElementById('click-power-display');
        const upgradesList = document.getElementById('upgrades-list');
        const ascendButton = document.getElementById('ascend-button');


        // --- Save/Load Functions ---

        /** Saves the current game state to the browser's local storage */
        function saveGame() {
            const gameData = {
                aura: aura,
                auraPerClick: auraPerClick,
                passiveUpgrades: passiveUpgrades,
                clickUpgrades: clickUpgrades // Save new upgrades
            };
            localStorage.setItem('leGodsAscensionSave', JSON.stringify(gameData));
        }

        /** Loads the game state from local storage */
        function loadGame() {
            const savedData = localStorage.getItem('leGodsAscensionSave');
            if (savedData) {
                const gameData = JSON.parse(savedData);
                
                aura = gameData.aura || 0;
                auraPerClick = gameData.auraPerClick || 1;
                
                // Load Passive Upgrades
                auraPerSecond = 0;
                (gameData.passiveUpgrades || []).forEach((savedUpgrade, index) => {
                    const localUpgrade = passiveUpgrades[index];
                    localUpgrade.owned = savedUpgrade.owned;
                    localUpgrade.cost = savedUpgrade.cost;
                    auraPerSecond += localUpgrade.aps * localUpgrade.owned;
                });
                
                // Load Click Upgrades
                (gameData.clickUpgrades || []).forEach((savedUpgrade, index) => {
                    const localUpgrade = clickUpgrades[index];
                    localUpgrade.owned = savedUpgrade.owned;
                    localUpgrade.cost = savedUpgrade.cost;
                    // Recalculate click power from loaded upgrades
                    // NOTE: auraPerClick is already loaded from gameData.auraPerClick, 
                    //       but this ensures consistency if the save file structure changes.
                });
            }
        }

        // --- Core Functions ---

        /** Updates all display elements (Aura, APS, Click Power) */
        function updateDisplay() {
            powerDisplay.textContent = Math.floor(aura).toLocaleString();
            apsDisplay.textContent = auraPerSecond.toFixed(1);
            clickPowerDisplay.textContent = auraPerClick.toLocaleString();
            renderUpgrades();
        }

        /** Handles the main button click */
        function generatePower() {
            aura += auraPerClick;
            updateDisplay();
            ascendButton.classList.add('clicked');
            setTimeout(() => ascendButton.classList.remove('clicked'), 100);
        }
        window.generatePower = generatePower;


        /** Purchase an upgrade (handles both passive and click upgrades) */
        function buyUpgrade(id) {
            const allUpgrades = [...passiveUpgrades, ...clickUpgrades];
            const upgrade = allUpgrades.find(u => u.id === id);
            
            if (!upgrade || aura < upgrade.cost) {
                return; // Not found or not enough aura
            }

            // Deduct cost and track ownership
            aura -= upgrade.cost;
            upgrade.owned += 1;
            
            // Apply effects
            if (upgrade.aps) { // Passive Upgrade
                auraPerSecond += upgrade.aps;
            }
            if (upgrade.clickBoost) { // NEW: Click Upgrade
                auraPerClick += upgrade.clickBoost;
            }

            // Increase cost exponentially
            upgrade.cost = Math.floor(upgrade.cost * 1.15); 

            updateDisplay();
            saveGame(); // Save after every purchase
        }
        window.buyUpgrade = buyUpgrade; // Make buyUpgrade accessible globally

        /** Renders the upgrade lists */
        function renderUpgrades() {
            upgradesList.innerHTML = '<h3>Passive (APS) Upgrades</h3>'; // Clear list and add Passive header
            
            // 1. Render Passive Upgrades
            passiveUpgrades.forEach(upgrade => {
                const isAffordable = aura >= upgrade.cost;
                upgradesList.appendChild(createUpgradeCard(upgrade, isAffordable));
            });

            upgradesList.innerHTML += '<h3 style="margin-top: 20px;">Click Power Upgrades</h3>'; // Add Click header
            
            // 2. Render Click Upgrades
            clickUpgrades.forEach(upgrade => {
                const isAffordable = aura >= upgrade.cost;
                upgradesList.appendChild(createUpgradeCard(upgrade, isAffordable));
            });
        }

        /** Helper function to create an upgrade card DOM element */
        function createUpgradeCard(upgrade, isAffordable) {
            const card = document.createElement('div');
            card.className = 'upgrade-card';
            
            const effectText = upgrade.aps 
                ? `Adds ${upgrade.aps.toFixed(1)} APS` 
                : `Adds ${upgrade.clickBoost.toLocaleString()} Click Power`;

            card.innerHTML = `
                <strong>${upgrade.name}</strong> (Owned: ${upgrade.owned}) <br>
                ${effectText} | Cost: ${Math.floor(upgrade.cost).toLocaleString()} Aura
                <button 
                    onclick="buyUpgrade(${upgrade.id})" 
                    ${isAffordable ? '' : 'disabled'}
                >
                    Buy
                </button>
            `;
            return card;
        }


        /** Game Loop: Generates passive aura every second and autosaves */
        function gameLoop() {
            aura += auraPerSecond / 10; // Run 10 times a second for smoother income display
            updateDisplay();
        }

        // --- Initialization ---

        loadGame(); // Try to load the game when the page opens
        
        // Start the game loop (run gameLoop function every 100 milliseconds)
        setInterval(gameLoop, 100); 

        // Autosave the game every 5 seconds
        setInterval(saveGame, 5000); 

        // Initial render
        renderUpgrades();
        updateDisplay(); 
              </script>
